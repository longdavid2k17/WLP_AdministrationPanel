<div class="summary">
    <mat-expansion-panel hideToggle>
        <mat-expansion-panel-header>
          <mat-panel-title style="font-weight: bold;">
            Summary
          </mat-panel-title>
          <mat-panel-description>
            Primary information about whole system condition.
          </mat-panel-description>
        </mat-expansion-panel-header>
        <div class="example-container mat-elevation-z8">
            <mat-table [dataSource]="dataSource" matSort>

                <!--- Note that these columns can be defined in any order.
                      The actual rendered columns are set as a property on the row definition" -->

                <!-- Position Column -->
                <ng-container matColumnDef="port">
                  <th mat-header-cell *matHeaderCellDef> Operational Port </th>
                  <td mat-cell *matCellDef="let element"> {{element.port}} </td>
                </ng-container>

                <!-- Name Column -->
                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef> Name </th>
                  <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                </ng-container>

                <!-- Weight Column -->
                <ng-container matColumnDef="hostAddress">
                  <th mat-header-cell *matHeaderCellDef> Host </th>
                  <td mat-cell *matCellDef="let element"> {{element.hostAddress}} </td>
                </ng-container>

                <!-- Symbol Column -->
                <ng-container matColumnDef="moduleVersion">
                  <th mat-header-cell *matHeaderCellDef> Version </th>
                  <td mat-cell *matCellDef="let element"> {{element.moduleVersion}} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </mat-table>
        </div>


      </mat-expansion-panel>
</div>

  <br/>
<div class="modules">
    <div class="spinner-wrapper" *ngIf="!querriedSuccessfully">
        <mat-spinner
        color="primary"
        mode="indeterminate"
        diameter="70"></mat-spinner><br/>
        <span style="text-align: center;position:absolute; clear:both;">Getting data for you</span>
      </div>
    <div class="header">
        <h3>Modules</h3>
        <div class="flex-stretch"></div>
        <button mat-icon-button (click)="search.value=''; queryServiceDiscovery()" *ngIf="search.value.length"><mat-icon>close</mat-icon></button>
        <button mat-icon-button *ngIf="!search.value.length" disabled><mat-icon>close</mat-icon></button>
        <mat-form-field>
        <input #search matInput (keydown.enter)="applyFilter($event)" placeholder="Search">
        </mat-form-field>
    </div>
    <div class="modules-content">
        <span>Last data update: {{queryDate | date:'HH:mm'}}</span>
        <div fxLayout="row wrap" fxLayoutGap="16px grid">
            <div [fxFlex]="(100/3) + '%'" fxFlex.xs="100%" fxFlex.sm="33%" *ngFor="let module of modules">
              <mat-card class="mat-elevation-z4">
                <mat-card-header>
                  <mat-card-title>{{module.moduleName}}</mat-card-title>
                </mat-card-header>
                <mat-card-subtitle>
                    <div class="flex-subtitle">
                        Service status: {{module.status}}
                        <div class="flex-stretch"></div>
                        <div class="balls" id="red" *ngIf="module.status && module.status==='DOWN'"></div>
                        <div class="balls" id="green" *ngIf="module.status && module.status==='RUNNING'"></div>
                    </div>
                </mat-card-subtitle>
                <mat-card-content>
                    <span><b>Service port</b>: {{module.servicePort}}</span><br/>
                    <span><b>Host address</b>: {{module.hostAddress}}</span><br/>
                    <span><b>Module version</b>: {{module.moduleVersion}}</span><br/>
                    <span><b>Swagger URL</b>: <a href="{{module.swaggerUrl}}" color="primary">{{module.swaggerUrl}}</a></span><br/>
                </mat-card-content>
                <mat-card-actions align="end">
                  <button
                  mat-icon-button
                  title="Export configuration"
                  (click)="exportConfiguration(module)"
                  color="primary">
                    <mat-icon>file_copy</mat-icon>
                </button>
                <button
                  mat-icon-button
                  title="Refresh state for {{module.moduleName}}"
                  (click)="refreshModuleState(module)"
                  color="primary">
                    <mat-icon>refresh</mat-icon>
                </button>
                <button
                  mat-icon-button
                  title="Supervise {{module.moduleName}} logs"
                  (click)="openLogWindow(module)"
                  color="primary">
                    <mat-icon>remove_red_eye</mat-icon>
                </button>
                </mat-card-actions>
              </mat-card>
            </div>
    </div>
</div>
</div>
